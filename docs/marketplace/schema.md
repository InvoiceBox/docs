---
layout: nocompress
nav_order: 10
title: "Схема взаимодействия"
parent: "Маркетплейс"
---

# Схема взаимодействия магазина и маркетплейса Инвойсбокс

<div class="mermaid">
sequenceDiagram
    autonumber
    participant Покупатель
    participant Маркетплейс
    participant Инвойсбокс
    participant Магазин
    rect rgb(204, 245, 204)
      Покупатель->>Маркетплейс: Выбор магазина, услуги или товара для покупки в маркетплейсе или на платёжной странице Инвойсбокс
      Маркетплейс->>Магазин: Инициализация микро-приложения
      Покупатель->>Магазин: Получение информации, активация услуги, оформление заказа на покупку
      Магазин->>Инвойсбокс: Вызов метода API создания заказа или обновления счёта
      Магазин->>Покупатель: Перенаправление на платёжную страницу Инвойсбокс
      Покупатель->>Инвойсбокс: Оплата счёта
      Инвойсбокс->>Магазин: Уведомление об успешной оплате заказа
      Инвойсбокс->>Покупатель: Перенаправление покупателя на микро-приложение магазина
      Магазин->>Покупатель: Отображение информации об оплаченной услуге или товаре
    end
</div>

1. Покупатель производит поиск товара, услуги или точки продаж в Маркетплейсе Инвойсбокс или выбирает дополнительные услуги на платёжной странице
1. Маркетплейс или платёжная страница инициализируют микро-приложение Магазина и передают ему (опционально) идентификатор текущего заказа (счёта) покупателя
1. Покупатель, используя микро-приложение, активирует услугу, оформляет заказ или покупку. Микро-приложение обменивается с родительским окном сообщениями (позитивые и негативные сценарии)
1. Микро-приложение Магазина вызывает метод API для [создания заказа](/order/create) или [обновления существующего](/order/update) (переданного) заказа (счёта)
1. Микро-приложение Магазина перенаправляет покупателя по полученной ссылке на платёжную страницу системы &laquo;Инвойсбокс&raquo;.
1. Покупатель оплачивает счёт.
1. Система &laquo;Инвойсбокс&raquo; оповещает Магазин об успешной оплате заказа
1. Система &laquo;Инвойсбокс&raquo; перенаправляет покупателя обратно на микро-приложение Магазина
1. Микро-приложение магазина отображает информацию об оплаченной услуге или товаре. Микро-приложение обменивается с родительским окном сообщениями (позитивые и негативные сценарии)

---

[Читать далее &raquo;](/docs/dictionary/){: .btn .btn-primary .fs-5 .mb-4 .mb-md-0 .mr-2 }

