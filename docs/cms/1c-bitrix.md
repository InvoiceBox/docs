---
layout: default
nav_order: 10
title: "1С Битрикс"
parent: "Модули для CMS"
---

# Описание модуля

![1С Битрикс](/assets/images/cms/1s_bitrix.svg)

Модуль 1С Битрикс предоставляет простую возможность подключить ваш интернет-магазин к системе оплаты «Инвойсбокс».
Модуль поддерживает два режима работы - с системой «Инвойсбокс» версии 2, а также с обновлённой версией 3.
Версию вашего подключения уточняйте у вашего персонального менеджера или в службе поддержки системы.

## Установка модуля

1. Зайдите в административную часть вашего сайта, перейдите на страницу «MarketPlace» → «Установленные решения»;
2. В списке доступных решений найдите модуль «Инвойсбокс» ([InvoiceBox, invoicebox.payment](https://marketplace.1c-bitrix.ru/solutions/invoicebox.payment/)) и установите его.

## Настройка модуля

В административном разделе сайта перейдите на страницу «Магазин» → «Платёжные системы» и нажмите на кнопку «Добавить платёжную систему».
На открывшейся странице:

1. Выберите "Обработчик": «Инвойсбокс» (invoicebox);
2. Выберите версию платёжной системы: Инвойсбокс v2 или Инвойсбокс v3;
3. Если требуется измените "Заголовок" и "Название";
4. :warning: (обязательно) Укажите кодировку "UTF-8";
5. :warning: (обязательно) Снимите, если установлены, 2 чекбокса "Разрешить печать чеков" и "Открывать в новом окне".

![1С Битрикс](/assets/images/cms/1c-bitrix/1.jpg)

В блоке «Настройка обработчика ПС» настройте следующие параметры:

- В случае выбора в типе платёжной системы версии Инвойсбокс v2, требуется заполнить поля из блока «Настройки подключения к Инвойсбокс v2»:
  - ID магазина — укажите идентификатор магазина, полученный при заключении договора;
  - Региональный код магазина — укажите региональный код магазина, полученный при заключении договора;
  - API ключ — укажите ключ безопасности, полученный при заключении договора;
  - URL страницы для отправки уведомлений — данный параметр обычно не требуется редактировать, т. к. он устанавливается по умолчанию и значение обязательно должно быть в виде http(s)://адрес_сайта/bitrix/tools/invoicebox/notification.php;
  - Тестовый режим - включите его для проведения тестовых платежей, при включении этого режима, вы пройдете все шаги в платежном терминале Инвойсбокс, но деньги с вашей карты списаны не будут.

![1С Битрикс](/assets/images/cms/1c-bitrix/2.png)

- В случае выбора в типе платежной системы версии Инвойсбокс v3, требуется заполнить поля из блока «Настройки подключения к Инвойсбокс v3»:
  - Идентификатор магазина -  укажите идентификатор магазина, полученный при заключении договора;
  - Авторизационный токен - токен формируется в момент регистрации магазина в системе «Инвойсбокс» и направляется по электронной почте в письме «Об активации в системе «Инвойсбокс». В случае, если вы не получили данный ключ, вы можете сформировать его автоматически в личном кабинете (в разделе Настройки);
  - Ключ для проверки подписи запроса — данный ключ можно получить в настройках интеграции магазина в ЛК Инвойсбокс;
  - Тип позиции у товаров каталога, Тип позиции у доставки — выберите один из двух вариантов (Товар или Сервис), данные поля необходимы для чека;
  - НДС на товары, НДС на доставку — выберите один из вариантов (не облагается, НДС 0%,. НДС 10%, НДС 20%, НДС брать из информации в товаре/ НДС брать из настроек доставки), данные поля необходимы для чека;
  - Тип оплаты — выберите один из вариантов (Полная предоплата, Предоплата, Аванс, Полная оплата), данные поля необходимы для чека;
  - URL страницы для отправки уведомлений — данный параметр обычно не требуется редактировать, т. к. он устанавливается по умолчанию и значение обязательно должно быть в виде http(s)://адрес_сайта/bitrix/tools/invoicebox/notification_v3.php.

![1С Битрикс](/assets/images/cms/1c-bitrix/3.png)

- Для любой выбранного типа платежной системы необходимо заполнить настройки в блоки «Основная»:
  - Автоматически оплачивать заказ при получении успешного статуса - при включении режима как только на сайт будет поступать информация об успешной оплате, заказ автоматически будет оплачиваться;
  - URL страницы для возврата на сайт Магазина  — при необходимости отредактируйте путь к странице для возврата на сайт Магазина;
  - URL страницы возврата при успешной оплате — при необходимости отредактируйте путь к странице, на которую попадет покупатель после успешной оплаты;
  - URL страницы возврата при отмене оплаты - при необходимости отредактируйте путь к странице, на которую попадет покупатель в случае отмены оплаты.

![1С Битрикс](/assets/images/cms/1c-bitrix/4.png)

При необходимости откорректируйте параметры в блоке «Оплаты»:

1. Единица измерения (по-умолчанию);
2. Описание оплаты;
3. Номер оплаты;
4. Сумма оплаты;
5. Валюта счёта;
6. Дата создания оплаты;
7. Статус после которого можно будет оплатить заказ — если Вам требуется отложенный платеж, выберите после какого статуса заказа разрешена будет оплата.

![1С Битрикс](/assets/images/cms/1c-bitrix/5.png)

В блоке «Покупатель» настройте следующие данные:

1. Тип плательщика — выберите один из вариантов (Физическое лицо, Юридическое лицо);
2. Название покупателя — для физических лиц рекомендуем указывать поля ФИО, для юридических лиц — название организации;
3. Телефон покупателя;
4. ИНН покупателя — рекомендуется передавать для юридических лиц;
5. Юр. адрес — рекомендуется передавать для юридических лиц.

При необходимости, вы можете внести изменения в настройках для разных типов плательщиков, для этого перейдите на нужную вкладку
("Физические лица" или "Юридические лица") и внесите необходимую информацию.

![1С Битрикс](/assets/images/cms/1c-bitrix/6.png)

## Настройка интернет-магазина

В административном разделе сайта перейдите на страницу «Настройки» → «Настройки продукта» → «Настройки модулей» → «Интернет-магазин»
и во вкладке «Автоматизация процессов» настройте смену статусов заказа при получении оплаты. 

## Настройка в личном кабинете ИнвойсБокс (для версии протокола 2)

- Перейдите в свой [личный кабинет](https://business.invoicebox.ru/) и авторизуйтесь;
- Перейдите в раздел «Начало работы» → «Настройки» → «Мои магазины» во вкладке «Уведомления по протоколу»:
  - Выберите «Тип уведомления»: "Оплата/HTTP/Post (HTTP POST запрос с данными оплаты в переменных)";
  - В поле "URL уведомления" укажите адрес Вашего сайта http://<адрес_вашего_сайта>/bitrix/tools/invoicebox/notification.php;
  - Проверьте корректность работы получения уведомления, нажав на кнопку «Отправить тестовый запрос»;
  - После проверки нажмите на кнопку «Сохранить».


---

[Проект на github](https://github.com/InvoiceBox/1c-bitrix)

